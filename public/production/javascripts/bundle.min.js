function getMobileOperatingSystem(){var e=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(e)?"Windows Phone":/android/i.test(e)?"Android":/iPad|iPhone|iPod/.test(e)&&!window.MSStream?"iOS":"unknown"}var app=angular.module("App",["ngRoute","ngMaterial","ngMessages","ngAnimate","ngSanitize"]);app.config(["$routeProvider","$locationProvider","$mdThemingProvider",function(e,t,n){e.when("/page/:page",{templateUrl:function(e){return"/partials/"+e.page},controller:"DiscussionCtrl",controllerAs:"discussionCtrl"}).when("/",{templateUrl:"/views/home.ejs"}),t.html5Mode({enabled:!0,requireBase:!1});var i=n.extendPalette("indigo",{contrastDefaultColor:"light",contrastDarkColors:["50"],50:"ffffff"});n.definePalette("custom",i),n.theme("default").primaryPalette("custom",{default:"500","hue-1":"50"}).accentPalette("amber")}]),$(window).on("load",function(e){"#_=_"==window.location.hash&&(window.location.hash="",history.pushState("",document.title,window.location.pathname),e.preventDefault())});var app=angular.module("App");app.controller("AuthenticationCtrl",["$http","$window","loaderAnimation",function(e,t,n){var i=this;this.data={email:"",password:"",password2:""},this.submit=function(o){e.post(o,i.data).success(function(e){e.redirect?(n.show(),t.location.href=e.redirect):i.message=e.message})}}]),app.directive("nemooLogin",function(){return{restrict:"E",templateUrl:"/views/login.ejs",controller:"AuthenticationCtrl",controllerAs:"loginCtrl"}}),app.directive("nemooSignUp",function(){return{restrict:"E",templateUrl:"/views/signup.ejs",controller:"AuthenticationCtrl",controllerAs:"signUpCtrl"}});var app=angular.module("App"),MAX_QUEUE_LENGTH=25,scrollBottom=function(){var e=document.getElementById("scrollable-container");$(e).scrollTop(e.scrollHeight)};app.controller("DiscussionCtrl",["$routeParams","$timeout","$scope","$templateCache","toastManager",function(e,t,n,i,o){var a=this,r=e.page;console.log(r),i.remove("/partials/"+r);document.getElementById("scrollable-container");t(function(){scrollBottom(),o.showSimple('Currently viewing "'+a.pageName+'"',3e3)}),this.init=function(e,t){e.page=r,this.main=e,this.pageName=t,this.main.socket.on(this.main.page+" message received",function(e,t){var i={displayName:t.displayName,profilePic:t.profilePic,backgroundColor:t.backgroundColor,created:t.created,message:e};a.data.length>MAX_QUEUE_LENGTH&&a.data.shift(),a.data.push(i),n.$apply()})}}]),app.animation(".animate-message",[function(){return{enter:function(e){$(e).addClass("animated bounce"),scrollBottom()}}}]);var app=angular.module("App"),options=["Advice","Animals","Automotive","Books","Business","Career","Celebrity","Debate","Entertainment","Environment","Family","Fashion","Finance","Food","Gaming","Health","Hobbies","Humor","Lifestyle","Movies","Music","News","Religion","Science","Sports","Technology","Television","Travel","Weather"];app.controller("DiscussionDialogCtrl",["$mdDialog","$location","$http","$scope","user","toastManager",function(e,t,n,i,o,a){var r=this;this.options=options.map(function(e){return{text:e,val:e.toLowerCase()}}),this.hide=function(){e.hide()},this.cancel=function(){e.cancel()},this.data={category:"",name:"",description:"",user:o},this.submit=function(e,i){var o=r.cleanData(r.data);n.post(e,o).success(function(e){e.redirect?(t.path(e.redirect),r.cancel(),a.showSimple("Successfully create discussion!!",3e3)):r.message=e.message})},this.cleanData=function(e){return{category:e.category,name:e.name.toLowerCase().split(" ").join("-"),description:e.description,user:e.user}}}]),function(e,t,n,i,o,a,r){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,a=t.createElement(n),r=t.getElementsByTagName(n)[0],a.async=1,a.src=i,r.parentNode.insertBefore(a,r)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-84261333-1","auto"),ga("send","pageview");var app=angular.module("App");app.controller("HeaderCtrl",["$scope","$window","$mdSidenav","$mdMedia","$mdDialog","$location","loaderAnimation",function(e,t,n,i,o,a,r){var s=this;e.$watch(function(){return i("gt-sm")},function(e){s.open=e}),this.togglePanel=function(){var e=n("left"),t=i("gt-sm");t?s.open=!s.open:e.toggle()},this.hardRedirect=function(e){r.show(),t.location.href=e},this.softRedirect=function(e){a.url(e)},this.showTabDialog=function(e,t){o.show({controller:["$mdDialog","$window",function(e,n){this.hide=function(){e.hide()},this.cancel=function(){e.cancel()},this.redirect=function(e){n.location.href=e},this.selected=t}],controllerAs:"dlgCtrl",templateUrl:"/views/loginDialog.ejs",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0})}}]),app.directive("nemooHeader",function(){return{restrict:"E",templateUrl:"/views/header.ejs",controller:"HeaderCtrl",controllerAs:"header"}});var app=angular.module("App");app.factory("loaderAnimation",function(){var e={};return e.show=function(){$("#loadingAnimation").css("display","block")},e.hide=function(){$("#loadingAnimation").css("display","none")},e});var app=angular.module("App");app.controller("MainCtrl",[function(){this.socket=io(),emojify.setConfig({img_dir:"/images/emoji"})}]);var app=angular.module("App");app.controller("MessageInputCtrl",["$timeout","$scope","$mdMedia",function(e,t,n){var i=this;this.message="",this.rows=1,e(function(){$("#message-input-box").focus()},0),this.send=function(){if(this.message){var e=emojify.replace(this.message);this.message=e,this.message=this.message.replace(/(?:\r\n|\r|\n)/g,"<br />"),this.main.socket.emit("message sent",this.message,this.main.user,this.main.page),this.message="",this.rows=1}},this.init=function(e){this.main=e},this.increaseRows=function(){this.rows++,this.message+="\n"},this.enterHandler=n("xs")?this.increaseRows:this.send,this.ctrlEnterHandler=n("xs")?this.send:this.increaseRows,t.$watch(function(){return $("#message-input-box").height()},function(e,t){if(e){var n=Math.min(30*i.rows,e);$("#message-input-box").attr("rows",i.rows).height(n)}})}]),app.directive("customKeyPress",function(){return function(e,t,n){t.bind("keydown keypress",function(t){if(13===t.which){var i=t.ctrlKey?"onCtrlEnterPressed":"onEnterPressed";e.$apply(function(){e.$eval(n[i])}),t.preventDefault()}})}}),app.directive("nemooMessageInput",function(){return{restrict:"E",templateUrl:"/views/messageInput.ejs",controller:"MessageInputCtrl",controllerAs:"messageCtrl"}});var app=angular.module("App"),general=[{url:"/explore",title:"Explore",icon:"cloud"},{url:"/settings",title:"Settings",icon:"settings"}];app.controller("PanelCtrl",["$location","$mdDialog","$mdSidenav","$mdMedia","$http",function(e,t,n,i,o){var a=this,r={callback:function(e){a.togglePanel(function(){t.show({controller:"DiscussionDialogCtrl",controllerAs:"dlgCtrl",templateUrl:"/views/createDiscussionDialog.ejs",parent:angular.element(document.body),locals:{user:a.main.user},targetEvent:e,clickOutsideToClose:!0})})},title:"Create Discussion",icon:"message"};general.unshift(r),this.general=general,o.get("/trendingDiscussions").then(function(e){a.trending=e.data.discussions.map(function(e){return{title:e}})}),this.init=function(e){a.main=e},this.unfocus=function(e,t){if(t.callback)t.callback(e);else{var n=t.url||"/page/"+t.title.toLowerCase().split(" ").join("-");a.togglePanel(function(){a.softRedirect(n)})}$(e.target).blur()},this.togglePanel=function(e){var t=n("left"),o=i("gt-sm");o?e():t.close().then(e)},this.removeSettings=function(e){return function(t){return"Settings"!==t.title||e}},this.softRedirect=function(t){e.url(t)}}]),app.directive("nemooPanel",function(){return{restrict:"E",templateUrl:"/views/panel.ejs",controller:"PanelCtrl",controllerAs:"panelCtrl"}});var app=angular.module("App");app.controller("SearchBoxCtrl",["$http","$q","$location","$mdSidenav","$mdMedia",function(e,t,n,i,o){var a=this;this.querySearch=function(n){var i=t.defer();return e.post("/searchDiscussion",{searchText:a.searchText}).then(function(e){i.resolve(e.data.discussions)}),i.promise},this.searchTextChange=function(e){},this.selectedItemChange=function(e){e&&this.togglePanel(function(){a.softRedirect("/page/"+e.name)})},this.togglePanel=function(e){var t=i("left"),n=o("gt-sm");n?e():t.close().then(e)},this.softRedirect=function(e){n.url(e)}}]),app.directive("nemooSearchBox",function(){return{restrict:"E",templateUrl:"/views/searchBox.ejs",controller:"SearchBoxCtrl",controllerAs:"searchBoxCtrl"}});var app=angular.module("App");app.factory("toastManager",["$mdToast",function(e){var t={};return t.showSimple=function(t,n){e.show(e.simple().textContent(t).position("bottom right").hideDelay(n))},t}]);var app=angular.module("App");app.controller("UserNavCtrl",["$window","$location","$mdSidenav","$mdMedia",function(e,t,n,i){var o=this;this.hardRedirect=function(t){e.location.href=t},this.softRedirect=function(e){t.url(e)},this.unfocus=function(e,t){var n=t||function(){};o.togglePanel(function(){$(e.target).blur(),n(e,0)})},this.togglePanel=function(e){n("left").close().then(e)}}]),app.directive("nemooUserNavPanel",function(){return{restrict:"E",templateUrl:"/views/userNavPanel.ejs",controller:"UserNavCtrl",controllerAs:"userNavCtrl"}});