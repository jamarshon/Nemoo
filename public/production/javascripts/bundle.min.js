function getMobileOperatingSystem(){var e=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(e)?"Windows Phone":/android/i.test(e)?"Android":/iPad|iPhone|iPod/.test(e)&&!window.MSStream?"iOS":"unknown"}var app=angular.module("App",["ngRoute","ngMaterial","ngMessages","ngAnimate","ngSanitize","ngDropdowns"]);app.config(["$routeProvider","$locationProvider","$mdThemingProvider","$compileProvider",function(e,t,n,o){e.when("/page/:page",{templateUrl:function(e){return"/partials/"+e.page},controller:"DiscussionCtrl",controllerAs:"discussionCtrl"}).when("/",{templateUrl:"/views/home.ejs"}),t.html5Mode({enabled:!0,requireBase:!1});var i=n.extendPalette("indigo",{contrastDefaultColor:"light",contrastDarkColors:["50"],50:"ffffff"});n.definePalette("custom",i),n.theme("default").primaryPalette("custom",{default:"500","hue-1":"50"}).accentPalette("amber")}]),$(window).on("load",function(e){"#_=_"==window.location.hash&&(window.location.hash="",history.pushState("",document.title,window.location.pathname),e.preventDefault())});var app=angular.module("App");app.controller("AdditionalOptionsDropdownCtrl",["$scope",function(e){e.ddSelectOptions=[{text:"Emoticon (People)",pageKey:"people"},{text:"Emoticon (Nature)",pageKey:"nature"},{text:"Emoticon (Object)",pageKey:"object"},{text:"Emoticon (Places)",pageKey:"places"},{text:"Emoticon (Symbol)",pageKey:"symbol"}],e.ddSelectSelected={text:"Emoticon (People)",pageKey:"people"},e.selectHandler=function(t){e.$parent.handlePageChange(t)}}]),app.directive("nemooAdditionalOptionsDropdown",function(){return{restrict:"E",scope:{},templateUrl:"/views/additionalOptionsDropdown.ejs",controller:"AdditionalOptionsDropdownCtrl"}});var app=angular.module("App");app.controller("AuthenticationCtrl",["$http","$window","loaderAnimation",function(e,t,n){var o=this;this.data={email:"",password:"",password2:""},this.submit=function(i){e.post(i,o.data).success(function(e){e.redirect?(n.show(),t.location.href=e.redirect):o.message=e.message})}}]),app.directive("nemooLogin",function(){return{restrict:"E",templateUrl:"/views/login.ejs",controller:"AuthenticationCtrl",controllerAs:"loginCtrl"}}),app.directive("nemooSignUp",function(){return{restrict:"E",templateUrl:"/views/signup.ejs",controller:"AuthenticationCtrl",controllerAs:"signUpCtrl"}});var app=angular.module("App"),MAX_QUEUE_LENGTH=25;app.controller("DiscussionCtrl",["$mdMedia","$routeParams","$timeout","$scope","$templateCache",function(e,t,n,o,i){var a=this,s=t.page;console.log(s),i.remove("/partials/"+s),this.init=function(e,t){e.page=s,this.main=e,this.pageName=t,this.main.socket.on(this.main.page+" message received",function(e,t){var n={displayName:t.displayName,profilePic:t.profilePic,backgroundColor:t.backgroundColor,created:t.created,message:e};a.data.length>MAX_QUEUE_LENGTH&&a.data.shift(),a.data.push(n),o.$apply()})}}]),app.animation(".animate-message",[function(){return{enter:function(e){$(e).addClass("animated bounce"),scrollBottom()}}}]);var app=angular.module("App"),options=["Advice","Animals","Automotive","Books","Business","Career","Celebrity","Debate","Entertainment","Environment","Family","Fashion","Finance","Food","Gaming","Health","Hobbies","Humor","Lifestyle","Movies","Music","News","Religion","Science","Sports","Technology","Television","Travel","Weather"];app.controller("DiscussionDialogCtrl",["$mdDialog","$location","$http","$scope","user","toastManager",function(e,t,n,o,i,a){var s=this;this.options=options.map(function(e){return{text:e,val:e.toLowerCase()}}),this.hide=function(){e.hide()},this.cancel=function(){e.cancel()},this.data={category:"",name:"",description:"",user:i},this.submit=function(e,o){var i=s.cleanData(s.data);n.post(e,i).success(function(e){e.redirect?(t.path(e.redirect),s.cancel(),a.showSimple("Successfully create discussion!!",3e3)):s.message=e.message})},this.cleanData=function(e){return{category:e.category,name:e.name.toLowerCase().split(" ").join("-"),description:e.description,user:e.user}}}]),function(e,t,n,o,i,a,s){e.GoogleAnalyticsObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,a=t.createElement(n),s=t.getElementsByTagName(n)[0],a.async=1,a.src=o,s.parentNode.insertBefore(a,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-84261333-1","auto"),ga("send","pageview");var app=angular.module("App");app.controller("HeaderCtrl",["$scope","$window","$mdSidenav","$mdMedia","$mdDialog","$location","loaderAnimation",function(e,t,n,o,i,a,s){var r=this;e.$watch(function(){return o("gt-sm")},function(e){r.open=e}),this.togglePanel=function(){var e=n("left"),t=o("gt-sm");t?r.open=!r.open:e.toggle()},this.hardRedirect=function(e){s.show(),t.location.href=e},this.softRedirect=function(e){a.url(e)},this.showTabDialog=function(e,t){i.show({controller:["$mdDialog","$window",function(e,n){this.hide=function(){e.hide()},this.cancel=function(){e.cancel()},this.redirect=function(e){n.location.href=e},this.selected=t}],controllerAs:"dlgCtrl",templateUrl:"/views/loginDialog.ejs",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0})}}]),app.directive("nemooHeader",function(){return{restrict:"E",templateUrl:"/views/header.ejs",controller:"HeaderCtrl",controllerAs:"header"}});var app=angular.module("App");app.factory("loaderAnimation",function(){var e={};return e.show=function(){$("#loadingAnimation").css("display","block")},e.hide=function(){$("#loadingAnimation").css("display","none")},e});var app=angular.module("App");app.controller("MainCtrl",[function(){this.socket=io(),emojify.setConfig({mode:"sprite"})}]);var app=angular.module("App");app.controller("MessageAdditionalOptionsCtrl",["$scope","$templateCache","$mdMedia",function(e,t,n){var o=this;t.remove("/views/messageAdditionalOptions.ejs"),this.pageKey="people",this.isLarge=n("gt-xs"),this.isAndroid="Android"===getMobileOperatingSystem(),this.isFocused=!1;var i=$("#message-additional-button > .material-icons"),a=$("#message-additional-button"),s=this.isLarge?function(){}:function(e){var t=$(window).width(),n=(t-278)/2,o=i.offset().left+i.width()/2-n;e.css("left",n),e.find(".webui-arrow").css("left",o)};a.webuiPopover({animation:"pop",url:"#myContent",onShow:s,trigger:"manual",closeable:!0}),this.showMenu=function(e){o.isFocused?a.webuiPopover("show"):($("#message-input-box").focus(),o.isAndroid?$(window).one("resize",function(){a.webuiPopover("show")}):a.webuiPopover("show")),e.preventDefault()},$("#message-input-box").on({focus:function(){o.isFocused=!0},blur:function(){o.isAndroid&&a.webuiPopover("hide"),o.isFocused=!1}}),this.addEmoji=function(t){var n=$(t.target),o="SPAN"===n.prop("tagName")?n:n.find("span");e.$parent.emoticonHandler(o.attr("title")),t.preventDefault()},e.handlePageChange=function(e){o.pageKey=e.pageKey},$("body").click(function(){console.log("m6onkey")}),e.$on("destroy",function(){})}]),app.directive("nemooMessageAdditionalOptions",function(){return{restrict:"E",scope:{},templateUrl:"/views/messageAdditionalOptions.ejs",controller:"MessageAdditionalOptionsCtrl",controllerAs:"messageAddCtrl"}});var app=angular.module("App"),scrollBottom=function(){var e=document.getElementById("scrollable-container");$(e).scrollTop(e.scrollHeight)};app.controller("MessageInputCtrl",["$timeout","$scope","$mdMedia","toastManager",function(e,t,n,o){var i=this;this.message="",this.rows=1,this.isLarge=n("gt-xs"),e(function(){if(i.isLarge){$("#message-input-box").focus();var e=$("#message-input-box").offset().top+26+48;e<$(window).height()&&o.showSimpleWithAction("Currently on "+i.main.page,1e3)}scrollBottom()}),this.send=function(){if(this.message){var e=emojify.replace(this.message);this.message=e,this.message=this.message.replace(/(?:\r\n|\r|\n)/g,"<br />"),this.main.socket.emit("message sent",this.message,this.main.user,this.main.page),this.message="",this.rows=1,$("#message-additional-button").webuiPopover("hide")}},this.init=function(e){this.main=e},this.increaseRows=function(){this.rows++,this.message+="\n"},this.enterHandler=this.isLarge?this.send:this.increaseRows,this.ctrlEnterHandler=this.isLarge?this.increaseRows:this.send,t.emoticonHandler=function(e){i.message+=" "+e+" "},t.$watch(function(){return $("#message-input-box").height()},function(e,t){if(e){var n=Math.min(30*i.rows,e);$("#message-input-box").attr("rows",i.rows).height(n)}})}]),app.directive("customKeyPress",function(){return function(e,t,n){t.bind("keydown keypress",function(t){if(13===t.which){var o=t.ctrlKey?"onCtrlEnterPressed":"onEnterPressed";e.$apply(function(){e.$eval(n[o])}),t.preventDefault()}})}}),app.directive("nemooMessageInput",function(){return{restrict:"E",templateUrl:"/views/messageInput.ejs",controller:"MessageInputCtrl",controllerAs:"messageCtrl"}});var app=angular.module("App"),general=[{url:"/explore",title:"Explore",icon:"cloud"},{url:"/settings",title:"Settings",icon:"settings"}];app.controller("PanelCtrl",["$location","$mdDialog","$mdSidenav","$mdMedia","$http",function(e,t,n,o,i){var a=this,s={callback:function(e){a.togglePanel(function(){t.show({controller:"DiscussionDialogCtrl",controllerAs:"dlgCtrl",templateUrl:"/views/createDiscussionDialog.ejs",parent:angular.element(document.body),locals:{user:a.main.user},targetEvent:e,clickOutsideToClose:!0})})},title:"Create Discussion",icon:"message"};general.unshift(s),this.general=general,i.get("/trendingDiscussions").then(function(e){a.trending=e.data.discussions.map(function(e){return{title:e}})}),this.init=function(e){a.main=e},this.unfocus=function(e,t){if(t.callback)t.callback(e);else{var n=t.url||"/page/"+t.title.toLowerCase().split(" ").join("-");a.togglePanel(function(){a.softRedirect(n)})}$(e.target).blur()},this.togglePanel=function(e){var t=n("left"),i=o("gt-sm");i?e():t.close().then(e)},this.removeSettings=function(e){return function(t){return"Settings"!==t.title||e}},this.softRedirect=function(t){e.url(t)}}]),app.directive("nemooPanel",function(){return{restrict:"E",templateUrl:"/views/panel.ejs",controller:"PanelCtrl",controllerAs:"panelCtrl"}});var app=angular.module("App");app.controller("SearchBoxCtrl",["$http","$q","$location","$mdSidenav","$mdMedia",function(e,t,n,o,i){var a=this;this.querySearch=function(n){var o=t.defer();return e.post("/searchDiscussion",{searchText:a.searchText}).then(function(e){o.resolve(e.data.discussions)}),o.promise},this.searchTextChange=function(e){},this.selectedItemChange=function(e){e&&this.togglePanel(function(){a.softRedirect("/page/"+e.name)})},this.togglePanel=function(e){var t=o("left"),n=i("gt-sm");n?e():t.close().then(e)},this.softRedirect=function(e){n.url(e)}}]),app.directive("nemooSearchBox",function(){return{restrict:"E",templateUrl:"/views/searchBox.ejs",controller:"SearchBoxCtrl",controllerAs:"searchBoxCtrl"}});var app=angular.module("App");app.factory("toastManager",["$mdToast",function(e){var t={};return t.showSimple=function(t,n){e.show(e.simple().textContent(t).position("bottom right").hideDelay(n))},t.showSimpleWithAction=function(t,n,o){e.show(e.simple().textContent(t).position("bottom right").hideDelay(n).action("CLOSE").highlightAction(!0).highlightClass("md-accent")).then(function(e){"ok"===e&&o&&o()})},t}]);var app=angular.module("App");app.controller("UserNavCtrl",["$window","$location","$mdSidenav","$mdMedia",function(e,t,n,o){var i=this;this.hardRedirect=function(t){e.location.href=t},this.softRedirect=function(e){t.url(e)},this.unfocus=function(e,t){var n=t||function(){};i.togglePanel(function(){$(e.target).blur(),n(e,0)})},this.togglePanel=function(e){n("left").close().then(e)}}]),app.directive("nemooUserNavPanel",function(){return{restrict:"E",templateUrl:"/views/userNavPanel.ejs",controller:"UserNavCtrl",controllerAs:"userNavCtrl"}});